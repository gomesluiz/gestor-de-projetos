"use strict";

$(function () {
  var $table = $('#bootstrap-table-example');
  var $remove = $('#bootstrap-table-remove');
  var selections = [];

  function getIdSelections() {
    return $.map($table.bootstrapTable('getSelections'), function (row) {
      return row.id;
    });
  }

  $table.bootstrapTable({
    height: 500,
    iconsPrefix: 'opacity-75 ion',
    icons: {
      paginationSwitchDown: 'ion-ios-arrow-down icon-chevron-down',
      paginationSwitchUp: 'ion-ios-arrow-up icon-chevron-up',
      refresh: 'ion-md-refresh icon-refresh',
      columns: 'ion-md-apps icon-th',
      detailOpen: 'ion-md-add icon-plus',
      detailClose: 'ion-md-remove icon-minus',
      export: 'ion-md-cloud-download icon-share'
    },
    detailFormatter: function detailFormatter(index, row) {
      var html = [];
      $.each(row, function (key, value) {
        html.push('<p><b>' + key + ':</b> ' + (typeof value === 'undefined' ? false : value) + '</p>');
      });
      return html.join('');
    },
    columns: [[{
      field: 'state',
      checkbox: true,
      rowspan: 2,
      align: 'center',
      valign: 'middle'
    }, {
      title: 'Item ID',
      field: 'id',
      rowspan: 2,
      align: 'center',
      valign: 'middle',
      sortable: true,
      footerFormatter: function totalTextFormatter(data) {
        return 'Total';
      }
    }, {
      title: 'Item Detail',
      colspan: 3,
      align: 'center'
    }], [{
      field: 'name',
      title: 'Item Name',
      sortable: true,
      editable: true,
      footerFormatter: function totalNameFormatter(data) {
        return data.length;
      },
      align: 'center'
    }, {
      field: 'price',
      title: 'Item Price',
      sortable: true,
      align: 'center',
      editable: {
        type: 'text',
        title: 'Item Price',
        validate: function validate(value) {
          value = $.trim(value);

          if (!value) {
            return 'This field is required';
          }

          if (!/^\$/.test(value)) {
            return 'This field needs to start width $.';
          }

          var data = $table.bootstrapTable('getData');
          var index = $(this).parents('tr').data('index'); // console.log(data[index]);

          return '';
        }
      },
      footerFormatter: function totalPriceFormatter(data) {
        var total = 0;
        $.each(data, function (i, row) {
          total += +row.price.substring(1);
        });
        return '$' + total;
      }
    }, {
      field: 'operate',
      title: 'Item Operate',
      align: 'center',
      events: {
        'click .like': function clickLike(e, value, row, index) {
          alert('You click like action, row: ' + JSON.stringify(row));
        },
        'click .remove': function clickRemove(e, value, row, index) {
          $table.bootstrapTable('remove', {
            field: 'id',
            values: [row.id]
          });
        }
      },
      formatter: function operateFormatter(value, row, index) {
        return ['<a class="btn btn-xs icon-btn btn-outline-default borderless like" href="javascript:void(0)" title="Like">', '<i class="ion ion-md-heart"></i>', '</a>  ', '<a class="btn btn-xs icon-btn btn-outline-danger borderless remove" href="javascript:void(0)" title="Remove">', '<i class="ion ion-md-close"></i>', '</a>'].join('');
      }
    }]]
  }); // sometimes footer render error.

  setTimeout(function () {
    $table.bootstrapTable('resetView');
  }, 200);
  $table.on('check.bs.table uncheck.bs.table ' + 'check-all.bs.table uncheck-all.bs.table', function () {
    $remove.prop('disabled', !$table.bootstrapTable('getSelections').length); // save your data, here just save the current page

    selections = getIdSelections(); // push or splice the selections if you want to save all data selections
  });
  $table.on('all.bs.table', function (e, name, args) {// console.log(name, args);
  });
  $remove.click(function () {
    var ids = getIdSelections();
    $table.bootstrapTable('remove', {
      field: 'id',
      values: ids
    });
    $remove.prop('disabled', true);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3RhYmxlc19ib290c3RyYXAtdGFibGUuanMiXSwibmFtZXMiOlsiJCIsIiR0YWJsZSIsIiRyZW1vdmUiLCJzZWxlY3Rpb25zIiwiZ2V0SWRTZWxlY3Rpb25zIiwibWFwIiwiYm9vdHN0cmFwVGFibGUiLCJyb3ciLCJpZCIsImhlaWdodCIsImljb25zUHJlZml4IiwiaWNvbnMiLCJwYWdpbmF0aW9uU3dpdGNoRG93biIsInBhZ2luYXRpb25Td2l0Y2hVcCIsInJlZnJlc2giLCJjb2x1bW5zIiwiZGV0YWlsT3BlbiIsImRldGFpbENsb3NlIiwiZXhwb3J0IiwiZGV0YWlsRm9ybWF0dGVyIiwiaW5kZXgiLCJodG1sIiwiZWFjaCIsImtleSIsInZhbHVlIiwicHVzaCIsImpvaW4iLCJmaWVsZCIsImNoZWNrYm94Iiwicm93c3BhbiIsImFsaWduIiwidmFsaWduIiwidGl0bGUiLCJzb3J0YWJsZSIsImZvb3RlckZvcm1hdHRlciIsInRvdGFsVGV4dEZvcm1hdHRlciIsImRhdGEiLCJjb2xzcGFuIiwiZWRpdGFibGUiLCJ0b3RhbE5hbWVGb3JtYXR0ZXIiLCJsZW5ndGgiLCJ0eXBlIiwidmFsaWRhdGUiLCJ0cmltIiwidGVzdCIsInBhcmVudHMiLCJ0b3RhbFByaWNlRm9ybWF0dGVyIiwidG90YWwiLCJpIiwicHJpY2UiLCJzdWJzdHJpbmciLCJldmVudHMiLCJlIiwiYWxlcnQiLCJKU09OIiwic3RyaW5naWZ5IiwidmFsdWVzIiwiZm9ybWF0dGVyIiwib3BlcmF0ZUZvcm1hdHRlciIsInNldFRpbWVvdXQiLCJvbiIsInByb3AiLCJuYW1lIiwiYXJncyIsImNsaWNrIiwiaWRzIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxDQUFDLENBQUMsWUFBVztBQUNYLE1BQUlDLE1BQU0sR0FBR0QsQ0FBQyxDQUFDLDBCQUFELENBQWQ7QUFDQSxNQUFJRSxPQUFPLEdBQUdGLENBQUMsQ0FBQyx5QkFBRCxDQUFmO0FBQ0EsTUFBSUcsVUFBVSxHQUFHLEVBQWpCOztBQUVBLFdB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QixDQUNoRDtBQUNELEdBRkQ7QUFJQTdELEVBQUFBLE9BQU8sQ0FBQzhELEtBQVIsQ0FBYyxZQUFXO0FBQ3ZCLFFBQUlDLEdBQUcsR0FBRzdELGVBQWUsRUFBekI7QUFFQUgsSUFBQUEsTUFBTSxDQUFDSyxjQUFQLENBQXNCLFFBQXRCLEVBQWdDO0FBQzlCcUIsTUFBQUEsS0FBSyxFQUFFLElBRHVCO0FBRTlCNkIsTUFBQUEsTUFBTSxFQUFFUztBQUZzQixLQUFoQztBQUlBL0QsSUFBQUEsT0FBTyxDQUFDMkQsSUFBUixDQUFhLFVBQWIsRUFBeUIsSUFBekI7QUFDRCxHQVJEO0FBVUQsQ0F4SkEsQ0FBRCIsInNvdXJjZXNDb250ZW50IjpbIiQoZnVuY3Rpb24oKSB7XG4gIHZhciAkdGFibGUgPSAkKCcjYm9vdHN0cmFwLXRhYmxlLWV4YW1wbGUnKTtcbiAgdmFyICRyZW1vdmUgPSAkKCcjYm9vdHN0cmFwLXRhYmxlLXJlbW92ZScpO1xuICB2YXIgc2VsZWN0aW9ucyA9IFtdO1xuXG4gIGZ1bmN0aW9uIGdldElkU2VsZWN0aW9ucygpIHtcbiAgICByZXR1cm4gJC5tYXAoJHRhYmxlLmJvb3RzdHJhcFRhYmxlKCdnZXRTZWxlY3Rpb25zJyksIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgIHJldHVybiByb3cuaWQ7XG4gICAgfSk7XG4gIH1cblxuICAkdGFibGUuYm9vdHN0cmFwVGFibGUoe1xuICAgIGhlaWdodDogNTAwLFxuICAgIGljb25zUHJlZml4OiAnb3BhY2l0eS03NSBpb24nLFxuICAgIGljb25zOiB7XG4gICAgICBwYWdpbmF0aW9uU3dpdGNoRG93bjogJ2lvbi1pb3MtYXJyb3ctZG93biBpY29uLWNoZXZyb24tZG93bicsXG4gICAgICBwYWdpbmF0aW9uU3dpdGNoVXA6ICdpb24taW9zLWFycm93LXVwIGljb24tY2hldnJvbi11cCcsXG4gICAgICByZWZyZXNoOiAnaW9uLW1kLXJlZnJlc2ggaWNvbi1yZWZyZXNoJyxcbiAgICAgIGNvbHVtbnM6ICdpb24tbWQtYXBwcyBpY29uLXRoJyxcbiAgICAgIGRldGFpbE9wZW46ICdpb24tbWQtYWRkIGljb24tcGx1cycsXG4gICAgICBkZXRhaWxDbG9zZTogJ2lvbi1tZC1yZW1vdmUgaWNvbi1taW51cycsXG4gICAgICBleHBvcnQ6ICdpb24tbWQtY2xvdWQtZG93bmxvYWQgaWNvbi1zaGFyZSdcbiAgICB9LFxuICAgIGRldGFpbEZvcm1hdHRlcjogZnVuY3Rpb24gZGV0YWlsRm9ybWF0dGVyKGluZGV4LCByb3cpIHtcbiAgICAgIHZhciBodG1sID0gW107XG5cbiAgICAgICQuZWFjaChyb3csIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIGh0bWwucHVzaCgnPHA+PGI+JyArIGtleSArICc6PC9iPiAnICsgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyBmYWxzZSA6IHZhbHVlKSArICc8L3A+Jyk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGh0bWwuam9pbignJyk7XG4gICAgfSxcbiAgICBjb2x1bW5zOiBbXG4gICAgICBbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWVsZDogJ3N0YXRlJyxcbiAgICAgICAgICBjaGVja2JveDogdHJ1ZSxcbiAgICAgICAgICByb3dzcGFuOiAyLFxuICAgICAgICAgIGFsaWduOiAnY2VudGVyJyxcbiAgICAgICAgICB2YWxpZ246ICdtaWRkbGUnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICB0aXRsZTogJ0l0ZW0gSUQnLFxuICAgICAgICAgIGZpZWxkOiAnaWQnLFxuICAgICAgICAgIHJvd3NwYW46IDIsXG4gICAgICAgICAgYWxpZ246ICdjZW50ZXInLFxuICAgICAgICAgIHZhbGlnbjogJ21pZGRsZScsXG4gICAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgICAgZm9vdGVyRm9ybWF0dGVyOiBmdW5jdGlvbiB0b3RhbFRleHRGb3JtYXR0ZXIoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICdUb3RhbCc7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgdGl0bGU6ICdJdGVtIERldGFpbCcsXG4gICAgICAgICAgY29sc3BhbjogMyxcbiAgICAgICAgICBhbGlnbjogJ2NlbnRlcidcbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIFtcbiAgICAgICAge1xuICAgICAgICAgIGZpZWxkOiAnbmFtZScsXG4gICAgICAgICAgdGl0bGU6ICdJdGVtIE5hbWUnLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICAgIGVkaXRhYmxlOiB0cnVlLFxuICAgICAgICAgIGZvb3RlckZvcm1hdHRlcjogZnVuY3Rpb24gdG90YWxOYW1lRm9ybWF0dGVyKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmxlbmd0aDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFsaWduOiAnY2VudGVyJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgZmllbGQ6ICdwcmljZScsXG4gICAgICAgICAgdGl0bGU6ICdJdGVtIFByaWNlJyxcbiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsXG4gICAgICAgICAgZWRpdGFibGU6IHtcbiAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIHRpdGxlOiAnSXRlbSBQcmljZScsXG4gICAgICAgICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgIHZhbHVlID0gJC50cmltKHZhbHVlKTtcblxuICAgICAgICAgICAgICBpZiAoIXZhbHVlKSB7IHJldHVybiAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZCc7IH1cbiAgICAgICAgICAgICAgaWYgKCEvXlxcJC8udGVzdCh2YWx1ZSkpIHsgcmV0dXJuICdUaGlzIGZpZWxkIG5lZWRzIHRvIHN0YXJ0IHdpZHRoICQuJyB9XG5cbiAgICAgICAgICAgICAgdmFyIGRhdGEgPSAkdGFibGUuYm9vdHN0cmFwVGFibGUoJ2dldERhdGEnKTtcbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gJCh0aGlzKS5wYXJlbnRzKCd0cicpLmRhdGEoJ2luZGV4Jyk7XG5cbiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YVtpbmRleF0pO1xuICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmb290ZXJGb3JtYXR0ZXI6IGZ1bmN0aW9uIHRvdGFsUHJpY2VGb3JtYXR0ZXIoZGF0YSkge1xuICAgICAgICAgICAgdmFyIHRvdGFsID0gMDtcblxuICAgICAgICAgICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uIChpLCByb3cpIHtcbiAgICAgICAgICAgICAgdG90YWwgKz0gKyhyb3cucHJpY2Uuc3Vic3RyaW5nKDEpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gJyQnICsgdG90YWw7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgZmllbGQ6ICdvcGVyYXRlJyxcbiAgICAgICAgICB0aXRsZTogJ0l0ZW0gT3BlcmF0ZScsXG4gICAgICAgICAgYWxpZ246ICdjZW50ZXInLFxuICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgJ2NsaWNrIC5saWtlJzogZnVuY3Rpb24gKGUsIHZhbHVlLCByb3csIGluZGV4KSB7XG4gICAgICAgICAgICAgIGFsZXJ0KCdZb3UgY2xpY2sgbGlrZSBhY3Rpb24sIHJvdzogJyArIEpTT04uc3RyaW5naWZ5KHJvdykpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdjbGljayAucmVtb3ZlJzogZnVuY3Rpb24gKGUsIHZhbHVlLCByb3csIGluZGV4KSB7XG4gICAgICAgICAgICAgICR0YWJsZS5ib290c3RyYXBUYWJsZSgncmVtb3ZlJywge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnaWQnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogW3Jvdy5pZF1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uIG9wZXJhdGVGb3JtYXR0ZXIodmFsdWUsIHJvdywgaW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICc8YSBjbGFzcz1cImJ0biBidG4teHMgaWNvbi1idG4gYnRuLW91dGxpbmUtZGVmYXVsdCBib3JkZXJsZXNzIGxpa2VcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgdGl0bGU9XCJMaWtlXCI+JyxcbiAgICAgICAgICAgICAgJzxpIGNsYXNzPVwiaW9uIGlvbi1tZC1oZWFydFwiPjwvaT4nLFxuICAgICAgICAgICAgICAnPC9hPiAgJyxcbiAgICAgICAgICAgICAgJzxhIGNsYXNzPVwiYnRuIGJ0bi14cyBpY29uLWJ0biBidG4tb3V0bGluZS1kYW5nZXIgYm9yZGVybGVzcyByZW1vdmVcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgdGl0bGU9XCJSZW1vdmVcIj4nLFxuICAgICAgICAgICAgICAnPGkgY2xhc3M9XCJpb24gaW9uLW1kLWNsb3NlXCI+PC9pPicsXG4gICAgICAgICAgICAgICc8L2E+J1xuICAgICAgICAgICAgXS5qb2luKCcnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICBdXG4gIH0pO1xuXG4gIC8vIHNvbWV0aW1lcyBmb290ZXIgcmVuZGVyIGVycm9yLlxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAkdGFibGUuYm9vdHN0cmFwVGFibGUoJ3Jlc2V0VmlldycpO1xuICB9LCAyMDApO1xuXG4gICR0YWJsZS5vbignY2hlY2suYnMudGFibGUgdW5jaGVjay5icy50YWJsZSAnICsgJ2NoZWNrLWFsbC5icy50YWJsZSB1bmNoZWNrLWFsbC5icy50YWJsZScsIGZ1bmN0aW9uICgpIHtcbiAgICAkcmVtb3ZlLnByb3AoJ2Rpc2FibGVkJywgISR0YWJsZS5ib290c3RyYXBUYWJsZSgnZ2V0U2VsZWN0aW9ucycpLmxlbmd0aCk7XG4gICAgLy8gc2F2ZSB5b3VyIGRhdGEsIGhlcmUganVzdCBzYXZlIHRoZSBjdXJyZW50IHBhZ2VcbiAgICBzZWxlY3Rpb25zID0gZ2V0SWRTZWxlY3Rpb25zKCk7XG4gICAgLy8gcHVzaCBvciBzcGxpY2UgdGhlIHNlbGVjdGlvbnMgaWYgeW91IHdhbnQgdG8gc2F2ZSBhbGwgZGF0YSBzZWxlY3Rpb25zXG4gIH0pO1xuXG4gICR0YWJsZS5vbignYWxsLmJzLnRhYmxlJywgZnVuY3Rpb24oZSwgbmFtZSwgYXJncykge1xuICAgIC8vIGNvbnNvbGUubG9nKG5hbWUsIGFyZ3MpO1xuICB9KTtcblxuICAkcmVtb3ZlLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgIHZhciBpZHMgPSBnZXRJZFNlbGVjdGlvbnMoKTtcblxuICAgICR0YWJsZS5ib290c3RyYXBUYWJsZSgncmVtb3ZlJywge1xuICAgICAgZmllbGQ6ICdpZCcsXG4gICAgICB2YWx1ZXM6IGlkc1xuICAgIH0pO1xuICAgICRyZW1vdmUucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgfSk7XG5cbn0pO1xuIl0sImZpbGUiOiJqcy90YWJsZXNfYm9vdHN0cmFwLXRhYmxlLmVzNS5qcyJ9
